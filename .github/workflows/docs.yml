name: Documentation

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  deploy-docs:
    name: Deploy Documentation
    runs-on: ubuntu-latest
    
    permissions:
      contents: read
      pages: write
      id-token: write
      
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Build documentation site
        run: |
          mkdir -p docs-site
          cp -r docs/* docs-site/
          cp README.md docs-site/
          cp CHANGELOG.md docs-site/
          
      - name: Create index page
        run: |
          cat > docs-site/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="en">
          <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Music Plugin Organizer - Documentation</title>
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                max-width: 1200px;
                margin: 0 auto;
                padding: 2rem;
                line-height: 1.6;
                color: #333;
              }
              h1 { color: #2563eb; }
              h2 { color: #1e40af; margin-top: 2rem; }
              a { color: #2563eb; text-decoration: none; }
              a:hover { text-decoration: underline; }
              .section { margin: 2rem 0; }
              .card {
                border: 1px solid #e5e7eb;
                border-radius: 0.5rem;
                padding: 1.5rem;
                margin: 1rem 0;
              }
            </style>
          </head>
          <body>
            <h1>Music Plugin Organizer Documentation</h1>
            <p>Visual mind-mapping tool for organizing music production plugins and sample libraries.</p>
            
            <div class="section">
              <h2>üìö Documentation</h2>
              <div class="card">
                <h3><a href="README.html">README</a></h3>
                <p>Getting started guide and project overview</p>
              </div>
              <div class="card">
                <h3><a href="CHANGELOG.html">CHANGELOG</a></h3>
                <p>Version history and release notes</p>
              </div>
            </div>
            
            <div class="section">
              <h2>üèóÔ∏è Architecture</h2>
              <div class="card">
                <h3><a href="architecture/decisions.html">Architecture Decisions</a></h3>
                <p>ADRs documenting major architectural choices</p>
              </div>
              <div class="card">
                <h3><a href="architecture/data-model.html">Data Model</a></h3>
                <p>Data structures and relationships</p>
              </div>
              <div class="card">
                <h3><a href="architecture/state-management.html">State Management</a></h3>
                <p>State management patterns and stores</p>
              </div>
            </div>
            
            <div class="section">
              <h2>üîó Links</h2>
              <ul>
                <li><a href="https://github.com/yourusername/music-plugin-organizer">GitHub Repository</a></li>
                <li><a href="https://github.com/yourusername/music-plugin-organizer/issues">Report Issues</a></li>
              </ul>
            </div>
          </body>
          </html>
          EOF
          
      - name: Setup Pages
        uses: actions/configure-pages@v4
        
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: docs-site
          
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4

